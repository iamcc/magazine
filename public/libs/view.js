// Generated by CoffeeScript 1.7.1
(function() {
  var $div, $item, $pages, curPage, height, i, itemNum, lastPage, move, moveNext, movePre, moving, play, _i;

  height = $(document).height();

  $pages = $('#pages');

  curPage = 0;

  lastPage = 20;

  moving = false;

  for (i = _i = 0; _i <= 20; i = ++_i) {
    $div = $('<div>');
    $div.attr('id', "page-" + i);
    $div.addClass('page');
    $div.css('background-color', "#" + ((Math.random() + '').slice(-6)));
    $div.css('position', 'relative');
    itemNum = ~~(Math.random() * 20) + 10;
    while (itemNum--) {
      $item = $('<div>');
      $item.addClass('item').html(Math.random() > .5 ? 'text' : '<img src="http://dummyimage.com/80x80/4d494d/686a82.gif&text=placeholder+image" alt="placeholder+image">').css({
        position: 'absolute',
        color: "#" + ((Math.random() + '').slice(-6)),
        'background-color': "#" + ((Math.random() + '').slice(-6)),
        'font-size': ~~(Math.random() * 20) + 10,
        'font-weight': Math.random() > .5 ? 'bold' : '',
        top: "" + (Math.random() * 100) + "%",
        left: "" + (Math.random() * 100) + "%",
        display: 'none'
      });
      $div.append($item);
    }
    $pages.append($div);
  }

  play = function(i) {
    return setTimeout(function() {
      return $("#page-" + i + " .item").each(function(j, item) {
        return $(item).velocity('transition.bounceDownIn', Math.random() * 2000, {
          delay: Math.random() * 1500
        });
      });
    }, 500);
  };

  move = function(n) {
    if (moving || curPage === 0 && n < 0 || curPage === lastPage && n > 0) {
      return;
    }
    moving = true;
    curPage += n;
    $("#page-" + (curPage - n) + " .item").velocity('stop').hide();
    return $pages.velocity({
      abc: 1
    }, function() {
      play(curPage);
      return moving = false;
    });
  };

  moveNext = function() {
    return move(1);
  };

  movePre = function() {
    return move(-1);
  };

  play(curPage);

  $(document).on('touchstart', function(e) {
    return e.preventDefault();
  }).on('touchmove', function(e) {
    return e.preventDefault();
  }).swipeUp(function(e) {
    return moveNext();
  }).swipeDown(function(e) {
    return movePre();
  });

}).call(this);
